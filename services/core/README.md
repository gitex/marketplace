## Core 

Ядро содержит в себе общие компоненты микросервисов.

### Публикация новой версии

Для публикации новой версии необходим запуск `pypi` в `docker-compose.yaml`. 
Если вы ещё не запустили `docker-compose`, то изучите инструкцию для запуска в основном `Readme`.

Если `pypi` уже запущен и файл `.htpasswd` сформирован, то запустите следующие команды:
```bash
just auth {username} {password}
just publish
```
Новая версия будет опубликована в локальный pypi и доступна для установки в микросервисах.

> Важно: не забудьте поменять версию после изменений в `pyproject.toml`

### Версионирование

Важно помнить, что каждое изменение, которое делается в `core`, потенциально "ломает" микросервисы. 
Для того, чтобы избежать прямого влияния на другие микросервисы, в сборку добавлена возможность **обратной совместимости**.

#### Пример

- У нас есть `service-1` и `service-2`. Оба ссылаются на `core="0.1.0"`
- Мы меняем `core` для `service-1`, но мы не знаем - затронет ли это изменение `service-2`
- Поэтому мы публикуем новую версию `core`, в `service-1` ссылаемся на `0.2.0`, а в `service-2` по прежнему ссылаемся на `0.1.0`

> Мы используем (Semantic Versioning)[https://semver.org/] для определения версий. 
Если возникает трудность "не знаю, на какую версию менять", то обязательно ознакомьтесь.

### Импорт

Все компоненты, которые добавляются в ядро, должны импортироваться напрямую из core:
```python
# неправильно
from core.mixins.models import TimeStampMixin

# правильно
from core import TimeStampMixin 
```
Это позволит в будущем менять архитектуру `core` без изменения зависимых микросервисов.

### TODO 

- [ ] Проверять последнюю опубликованную версию (justfile)
- [ ] Проверять изменение версии перед коммитом (pre-commit)
- [ ] Упросить изменение версии 
